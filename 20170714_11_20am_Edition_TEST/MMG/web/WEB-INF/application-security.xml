<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:security="http://www.springframework.org/schema/security"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/security
              http://www.springframework.org/schema/security/spring-security-3.0.3.xsd
              http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">


    <security:http auto-config="false">
        
        <security:form-login login-page="/WEB-INF/jsp/index.jsp" default-target-url="/WEB-INF/jsp/index.jsp" />
       <!-- <security:custom-filter before"FORM_LOGIN_FILTER" ref="TestFilter"/>  
        <security:custom-filter after="FILTER_SECURITY_INTERCEPTOR" ref="TokenVerifierFilter"/>   -->


        <security:custom-filter before="FILTER_SECURITY_INTERCEPTOR" ref="RequestLoggingFilter" />


        <security:intercept-url pattern="/client/guid"  filters="none" requires-channel="any"/>
        <security:intercept-url pattern="/client/token"  filters="none" requires-channel="any"/>
        <security:intercept-url pattern="/client/user/verify"  filters="none" requires-channel="any"/> 
        <security:intercept-url pattern="/client/user/**"  filters="none" requires-channel="any"/>
        <security:intercept-url pattern="/client/vehicle/**"  filters="none" requires-channel="any"/>
        <security:intercept-url pattern="/client/dealercoupons/**"  filters="none" requires-channel="any"/>
        <security:intercept-url pattern="/client/mileage/vehicle/*"  filters="none" requires-channel="any"/>
        <security:intercept-url pattern="/client/servicehistory/*"  filters="none" requires-channel="any"/>
        <security:intercept-url pattern="/client/maintenance/*"  filters="none" requires-channel="any"/>
        <security:intercept-url pattern="/client/test/*"  filters="none" requires-channel="any"/>
        <security:intercept-url pattern="/client/search/*"   requires-channel="any"/>
        <security:intercept-url pattern="/client/howto/**"   requires-channel="any"/>
        <security:intercept-url pattern="/client/**/*"   requires-channel="any"/>
        <!--<security:intercept-url pattern="/client/barcode/**"   requires-channel="any" />-->

        
        <security:intercept-url pattern="/*"   requires-channel="any"/>
    </security:http>


    <!-- Declaring all the filters that had to be used in the application  -->
    
    <bean id="TokenVerifierFilter" class="com.emm.v1.session.filters.TokenVerifierFilter"/>
    <bean id="RequestLoggingFilter" class="com.mazdausa.mmg.client.request.filters.RequestLoggingFilter"/>


    <security:authentication-manager alias="authenticationManager">
        <security:authentication-provider>
            <security:user-service>
                <security:user name="jimi" password="jimispassword" authorities="ROLE_USER, ROLE_ADMIN" />
                <security:user name="bob" password="bobspassword" authorities="ROLE_USER" />
            </security:user-service>
        </security:authentication-provider>
    </security:authentication-manager>
        <!--</authentication-manager> -->
        

</beans>